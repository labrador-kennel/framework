#!/usr/bin/env php
<?php declare(strict_types=1);

use Cspray\AnnotatedContainer\Cli\CommandExecutor;
use Cspray\AnnotatedContainer\Cli\InputParser;
use Cspray\AnnotatedContainer\Cli\TerminalOutput;
use Labrador\Http\Cli\WebCommand;

exit((function($argc, $argv) {
    $root = $labradorRoot = dirname(__DIR__);
    if (!file_exists($root . '/vendor/autoload.php')) {
        $root = dirname(__DIR__, 4);
    }

    require_once $root . '/vendor/autoload.php';

    $commandExecutor = new CommandExecutor();

    $commandExecutor->addCommand(new WebCommand($labradorRoot . '/src/GettingStarted/container-bootstrap.php'));

    $input = (new InputParser())->parse($argv);
    $terminalOutput = new TerminalOutput();

    return $commandExecutor->execute($input, $terminalOutput);
})($argc, $argv));

